% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/horseshoe_sampler.R
\name{horseshoe_sampler}
\alias{horseshoe_sampler}
\title{Fit a Bayesian linear regression for treatment effect heterogeneity.}
\usage{
horseshoe_sampler(
  X,
  y,
  z,
  num_iterations = 2000,
  burn_in = 1000,
  mu_model = list(gibbs = TRUE, global_shrink = TRUE, unlink = FALSE),
  tau_model = list(gibbs = TRUE, global_shrink = TRUE, unlink = FALSE),
  propensity_separate = FALSE,
  initial_sigma = 1,
  alpha_prior_sd = 10,
  seed = 1848,
  standardize_cov = F,
  interaction_rule
)
}
\arguments{
\item{X}{A numeric matrix or data frame of covariates.}

\item{y}{A numeric vector of outcomes.}

\item{z}{A numeric vector of treatment assignments (e.g., 0 or 1).}

\item{num_iterations}{Total number of MCMC iterations.}

\item{burn_in}{Number of burn-in iterations to discard.}

\item{mu_model}{A list of options for the mu(x) model component.
\itemize{
\item \code{gibbs}: (logical) Whether to use a Gibbs sampler for coefficients.
\item \code{global_shrink}: (logical) Whether to use a global shrinkage parameter.
\item \code{unlink}: (logical) Whether to unlink interaction term shrinkage from main effect shrinkage.
\item \code{p_int}: (integer) The number of interaction terms to include.
}}

\item{tau_model}{A list of options for the tau(x) model component, with the same structure as \code{mu_model}.}

\item{propensity_separate}{(logical) Whether to separately model the propensity score.}

\item{initial_sigma}{(double) The initial value for the residual standard deviation.}

\item{alpha_prior_sd}{(double) The standard deviation of the prior on the intercept terms.}

\item{seed}{(integer) Initializes the random state.}

\item{standardize_cov}{(logical) Indicates whether the covariates should be standardized.}

\item{interaction_rule}{(string) Indicates which interaction rule should be used.}
}
\value{
A list object of class \code{stochtree_hs} containing the posterior samples for all model parameters.
\itemize{
\item \code{mu_samples}: A list of posterior samples for the mu(x) component (alpha, beta, etc.).
\item \code{tau_samples}: A list of posterior samples for the tau(x) component (alpha, beta, etc.).
\item \code{sigma_samples}: A vector of posterior samples for the residual standard deviation sigma.
}
}
\description{
This function fits a model of the form y = mu(x) + z * tau(x) + epsilon,
where mu(x) is the prognostic effect and tau(x) is the treatment effect.
Both mu(x) and tau(x) are linear models with coefficients given a horseshoe
prior. This allows for flexible modeling of treatment effect heterogeneity.
}
\examples{
\dontrun{
# Generate some sample data
n <- 200
p <- 5
X <- matrix(rnorm(n * p), ncol = p)
z <- rbinom(n, 1, 0.5)
mu_x <- 1 + X[,1] * 0.5 - X[,3]
tau_x <- 1.5 + X[,2] * 2
y <- mu_x + z * tau_x + rnorm(n, 0, 1)

# Fit the model
fit <- horseshoe_sampler(
  X = X, y = y, z = z,
  num_iterations = 2000,
  burn_in = 1000,
  mu_model = list(gibbs = TRUE, global_shrink = TRUE, unlink = FALSE, p_int = 0),
  tau_model = list(gibbs = TRUE, global_shrink = TRUE, unlink = FALSE, p_int = 0)
)

# Summarize the results
summary(fit)

# Plot posterior distributions
plot(fit)
}
}
